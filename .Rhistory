if (Sys.info()["user"] != "DezLinYiming"){hpc = "/rds/general/user/dl1220/home/M4RKernel/"
}else{
hpc=""
setwd("D:/Math/Y4/M4R/M4RKernel")
set_cmdstan_path("E:/cmdstan/cmdstan-2.33.1")}
x = read.csv('output/post/HIV/HIV_HSGP_m12_cd/HIV_HSGP_m12_cd_computing-time.csv')
max(x)
max(x)/60
x = read.csv('output/post/HIV/HIV_HSGP_m12_rd/HIV_HSGP_m12_rd_computing-time.csv')
max(x)/60
x = read.csv('output/post/HIV/HIV_HSGP_m32_rd/HIV_HSGP_m32_rd_computing-time.csv')
max(x)/60
x = read.csv('output/post/HIV/HIV_HSGP_m32_cd/HIV_HSGP_m32_cd_computing-time.csv')
max(x)/60
x = read.csv('output/post/HIV/HIV_HSGP_m52_cd/HIV_HSGP_m52_cd_computing-time.csv')
max(x)/60
x = read.csv('output/post/HIV/HIV_HSGP_m52_rd/HIV_HSGP_m52_rd_computing-time.csv')
max(x)/60
x = read.csv('output/post/HIV/HIV_HSGP_eq_rd/HIV_HSGP_eq_rd_computing-time.csv')
max(x)/60
x = read.csv('output/post/HIV/HIV_HSGP_eq_cd/HIV_HSGP_eq_cd_computing-time.csv')
max(x)/60
`HIV_HSGP_eq_cd_contact-intensities_within_age_age_sex` <- readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_eq_cd/HIV_HSGP_eq_cd_contact-intensities_within_age_age_sex.rds")
source("D:/Math/Y4/M4R/M4RKernel/helper_func/plot_functions.R", echo=TRUE)
plot_contact_intensity_matrix(`HIV_HSGP_eq_cd_contact-intensities_within_age_age_sex`)
# Preamble: Generates diagnostic statistics and result plots
library(optparse)
library(data.table)
library(yaml)
library(cmdstanr)
library(bayesplot)
library(loo)
library(reshape2)
library(stringr)
library(ggplot2)
library(viridis)
library(pammtools)
plot_contact_intensity_matrix(`HIV_HSGP_eq_cd_contact-intensities_within_age_age_sex`)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_eq_rd/HIV_HSGP_eq_rd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_m52_rd/HIV_HSGP_m52_rd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_m52_cd/HIV_HSGP_m52_cd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_m52_cd/HIV_HSGP_m52_cd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_m52_rd/HIV_HSGP_m52_rd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_eq_rd/HIV_HSGP_m52_eq_contact-intensities_within_age_age_sex.rds")
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_eq_cd/HIV_HSGP_eq_cd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_sd_matrix(data)
plot_contact_intensity_sd_matrix = function(d22)
{
d22$sd = list(sapply(d22$sd, max_X))
ggplot(d22) +
geom_tile(aes(x = part.age, y = cont.age, fill = sd)) +
coord_equal() +
# geom_abline(slope = 1, intercept = 0, colour = 'white', size = 1.5, linetype = 2) +
facet_grid( ~ paste0("Participants' sex: ",  part.sex )) +
viridis::scale_fill_viridis(na.value="white", option="H") +
# scale_fill_gradient2(low = "darkblue", high = "darkgreen", guide = "colorbar", na.value = 'white'
# ) +
theme_bw() +
xlab("Age of contacting individuals") +
ylab("Age of contacted individuals") +
theme(legend.position = "right",  # Position the legend to the right
legend.direction = "vertical",  # Make the legend vertical)
strip.background = element_rect(color=NA, fill = "transparent"))
}
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_m52_cd/HIV_HSGP_m52_cd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_m52_rd/HIV_HSGP_m52_rd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_m52_rd/HIV_2dHSGP_m52_m52-rd_contact-intensities_within_age_age_sex.rds")
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_m52_m52-rd/HIV_2dHSGP_m52_m52-rd_contact-intensities_within_age_age_sex.rds")
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_2dHSGP_m52_m52-rd/HIV_2dHSGP_m52_m52-rd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_2dHSGP_m52_m52-cd/HIV_2dHSGP_m52_m52-cd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_2dHSGP_con_m52-cd/HIV_2dHSGP_con_m52-cd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_2dHSGP_con_m52-rd/HIV_2dHSGP_con_m52-rd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
plot_contact_intensity_sd_matrix = function(d22)
{
d22$sd = list(sapply(d22$sd, max_X))
ggplot(d22) +
geom_tile(aes(x = part.age, y = cont.age, fill = sd)) +
labs(fill='Uncertainty')
coord_equal() +
# geom_abline(slope = 1, intercept = 0, colour = 'white', size = 1.5, linetype = 2) +
facet_grid( ~ paste0("Participants' sex: ",  part.sex )) +
viridis::scale_fill_viridis(na.value="white", option="H") +
# scale_fill_gradient2(low = "darkblue", high = "darkgreen", guide = "colorbar", na.value = 'white'
# ) +
theme_bw() +
xlab("Age of contacting individuals") +
ylab("Age of contacted individuals") +
theme(legend.position = "right",  # Position the legend to the right
legend.direction = "vertical",  # Make the legend vertical)
strip.background = element_rect(color=NA, fill = "transparent"))
}
plot_contact_intensity_sd_matrix(data)
plot_contact_intensity_sd_matrix = function(d22)
{
d22$sd = list(sapply(d22$sd, max_X))
ggplot(d22) +
geom_tile(aes(x = part.age, y = cont.age, fill = sd)) +
labs(fill='Uncertainty'),
ggplot(d22) +
geom_tile(aes(x = part.age, y = cont.age, fill = sd)) +
labs(fill='Uncertainty')+
coord_equal() +
# geom_abline(slope = 1, intercept = 0, colour = 'white', size = 1.5, linetype = 2) +
facet_grid( ~ paste0("Participants' sex: ",  part.sex )) +
viridis::scale_fill_viridis(na.value="white", option="H") +
# scale_fill_gradient2(low = "darkblue", high = "darkgreen", guide = "colorbar", na.value = 'white'
# ) +
theme_bw() +
xlab("Age of contacting individuals") +
ylab("Age of contacted individuals") +
theme(legend.position = "right",  # Position the legend to the right
legend.direction = "vertical",  # Make the legend vertical)
strip.background = element_rect(color=NA, fill = "transparent"))
plot_contact_intensity_sd_matrix = function(d22)
{
d22$sd = list(sapply(d22$sd, max_X))
ggplot(d22) +
geom_tile(aes(x = part.age, y = cont.age, fill = sd)) +
labs(fill='Uncertainty')+
coord_equal() +
# geom_abline(slope = 1, intercept = 0, colour = 'white', size = 1.5, linetype = 2) +
facet_grid( ~ paste0("Participants' sex: ",  part.sex )) +
viridis::scale_fill_viridis(na.value="white", option="H") +
# scale_fill_gradient2(low = "darkblue", high = "darkgreen", guide = "colorbar", na.value = 'white'
# ) +
theme_bw() +
xlab("Age of contacting individuals") +
ylab("Age of contacted individuals") +
theme(legend.position = "right",  # Position the legend to the right
legend.direction = "vertical",  # Make the legend vertical)
strip.background = element_rect(color=NA, fill = "transparent"))
}
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_2dHSGP_con_m52-cd/HIV_2dHSGP_con_m52-cd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_con_cd/HIV_HSGP_con_cd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
plot_contact_intensity_sd_matrix(data)
data <-
readRDS("D:/Math/Y4/M4R/M4RKernel/output/post/HIV/HIV_HSGP_con_rd/HIV_HSGP_con_rd_contact-intensities_within_age_age_sex.rds")
plot_contact_intensity_matrix(data)
plot_contact_intensity_sd_matrix(data)
